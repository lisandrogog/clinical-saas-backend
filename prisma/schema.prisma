generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model access_scope {
  id          Int          @id @default(autoincrement())
  code        String       @unique @db.VarChar(30)
  name        String       @db.VarChar(50)
  description String?
  item_order  Int          @default(0)
  readonly    Boolean      @default(false)
  permission  permission[]
}

model app_module {
  id             Int              @id @default(autoincrement())
  platform_id    Int?
  name           String?          @db.VarChar(100)
  code           String?          @db.VarChar(50)
  item_order     Int              @default(0)
  readonly       Boolean          @default(false)
  platform       platform?        @relation(fields: [platform_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  app_sub_module app_sub_module[]

  @@unique([platform_id, code])
}

model app_sub_module {
  id            Int          @id @default(autoincrement())
  app_module_id Int?
  name          String?      @db.VarChar(100)
  code          String?      @db.VarChar(50)
  item_order    Int          @default(0)
  readonly      Boolean      @default(false)
  app_module    app_module?  @relation(fields: [app_module_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  permission    permission[]

  @@unique([app_module_id, code])
}

model app_user {
  id                     String                   @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_partner_id    String                   @db.Uuid
  role_id                String                   @db.Uuid
  status_id              Int
  username               String                   @db.VarChar(100)
  password_hash          String
  profile_data           Json?
  created_at             DateTime                 @default(now()) @db.Timestamptz(6)
  created_by             String?                  @db.Uuid
  updated_at             DateTime?                @db.Timestamptz(6)
  updated_by             String?                  @db.Uuid
  removed_at             DateTime?                @db.Timestamptz(6)
  removed_by             String?                  @db.Uuid
  readonly               Boolean                  @default(false)
  business_partner       business_partner         @relation(fields: [business_partner_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  role                   role                     @relation(fields: [role_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  app_user_status        app_user_status          @relation(fields: [status_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  app_user_business_unit app_user_business_unit[]

  @@unique([business_partner_id, removed_at], map: "uq_app_user_partner")
  @@unique([username, removed_at], map: "uq_app_user_username")
}

model app_user_business_unit {
  id               String        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  app_user_id      String        @db.Uuid
  business_unit_id String        @db.Uuid
  created_at       DateTime      @default(now()) @db.Timestamptz(6)
  created_by       String?       @db.Uuid
  app_user         app_user      @relation(fields: [app_user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  business_unit    business_unit @relation(fields: [business_unit_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([app_user_id, business_unit_id])
}

model app_user_status {
  id          Int        @id @default(autoincrement())
  code        String     @unique @db.VarChar(20)
  name        String     @db.VarChar(50)
  description String?
  item_order  Int        @default(0)
  readonly    Boolean    @default(false)
  app_user    app_user[]
}

model business_partner {
  id                                                        String                           @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                 String                           @db.Uuid
  identification_type_id                                    Int
  identification_number                                     String                           @db.VarChar(255)
  first_name                                                String?                          @db.VarChar(100)
  last_name                                                 String?                          @db.VarChar(100)
  email                                                     String?                          @db.VarChar(255)
  phone                                                     String?                          @db.VarChar(50)
  address                                                   String?
  is_customer                                               Boolean                          @default(false)
  is_agent                                                  Boolean                          @default(false)
  active                                                    Boolean                          @default(true)
  extra_data                                                Json?
  created_at                                                DateTime                         @default(now()) @db.Timestamptz(6)
  created_by                                                String?                          @db.Uuid
  updated_at                                                DateTime?                        @db.Timestamptz(6)
  updated_by                                                String?                          @db.Uuid
  removed_at                                                DateTime?                        @db.Timestamptz(6)
  removed_by                                                String?                          @db.Uuid
  is_supplier                                               Boolean                          @default(false)
  readonly                                                  Boolean                          @default(false)
  app_user                                                  app_user[]
  identification_type                                       identification_type              @relation(fields: [identification_type_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenant                                                    tenant                           @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  business_partner_business_unit                            business_partner_business_unit[]
  service_order_service_order_agent_idTobusiness_partner    service_order[]                  @relation("service_order_agent_idTobusiness_partner")
  service_order_service_order_customer_idTobusiness_partner service_order[]                  @relation("service_order_customer_idTobusiness_partner")
  service_provider                                          service_provider[]

  @@unique([tenant_id, identification_number, identification_type_id, removed_at], map: "uq_business_partner")
}

model business_unit {
  id                             String                           @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                      String                           @db.Uuid
  code                           String                           @db.VarChar(50)
  business_name                  String                           @db.VarChar(255)
  email                          String?                          @db.VarChar(255)
  phone                          String?                          @db.VarChar(50)
  address                        String?
  active                         Boolean                          @default(true)
  created_at                     DateTime                         @default(now()) @db.Timestamptz(6)
  created_by                     String?                          @db.Uuid
  updated_at                     DateTime?                        @db.Timestamptz(6)
  updated_by                     String?                          @db.Uuid
  removed_at                     DateTime?                        @db.Timestamptz(6)
  removed_by                     String?                          @db.Uuid
  app_user_business_unit         app_user_business_unit[]
  business_partner_business_unit business_partner_business_unit[]
  tenant                         tenant                           @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  service_business_unit          service_business_unit[]
  service_order                  service_order[]
  service_provider_schedule      service_provider_schedule[]
  service_provider_service       service_provider_service[]

  @@unique([tenant_id, code, removed_at], map: "uq_business_unit")
}

model document_action {
  id                   Int                    @id @default(autoincrement())
  code                 String                 @unique @db.VarChar(50)
  name                 String                 @db.VarChar(100)
  readonly             Boolean                @default(false)
  item_order           Int                    @default(0)
  document_engine_item document_engine_item[]
}

model document_engine {
  id                   String                 @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  code                 String                 @db.VarChar(100)
  name                 String                 @db.VarChar(250)
  description          String?
  document_type_id     Int
  initial_state_id     Int
  is_default           Boolean                @default(false)
  readonly             Boolean                @default(false)
  document_type        document_type          @relation(fields: [document_type_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  document_status      document_status        @relation(fields: [initial_state_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  document_engine_item document_engine_item[]
}

model document_engine_item {
  id                                                                  String          @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  document_engine_id                                                  String          @db.Uuid
  document_action_id                                                  Int
  from_state_id                                                       Int
  to_state_id                                                         Int
  readonly                                                            Boolean         @default(false)
  document_action                                                     document_action @relation(fields: [document_action_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  document_engine                                                     document_engine @relation(fields: [document_engine_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  document_status_document_engine_item_from_state_idTodocument_status document_status @relation("document_engine_item_from_state_idTodocument_status", fields: [from_state_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  document_status_document_engine_item_to_state_idTodocument_status   document_status @relation("document_engine_item_to_state_idTodocument_status", fields: [to_state_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([document_engine_id, from_state_id, to_state_id])
}

model document_status {
  id                                                                       Int                    @id @default(autoincrement())
  code                                                                     String                 @unique @db.VarChar(20)
  name                                                                     String                 @db.VarChar(50)
  is_editable                                                              Boolean                @default(false)
  is_final                                                                 Boolean                @default(false)
  is_posted                                                                Boolean                @default(false)
  allow_backwards                                                          Boolean                @default(false)
  readonly                                                                 Boolean                @default(false)
  item_order                                                               Int                    @default(0)
  document_engine                                                          document_engine[]
  document_engine_item_document_engine_item_from_state_idTodocument_status document_engine_item[] @relation("document_engine_item_from_state_idTodocument_status")
  document_engine_item_document_engine_item_to_state_idTodocument_status   document_engine_item[] @relation("document_engine_item_to_state_idTodocument_status")
  service_order                                                            service_order[]
}

model document_type {
  id              Int               @id @default(autoincrement())
  code            String            @unique @db.VarChar(20)
  name            String            @db.VarChar(250)
  readonly        Boolean           @default(false)
  document_engine document_engine[]
  service_order   service_order[]
}

model identification_type {
  id               Int                @id @default(autoincrement())
  code             String             @unique @db.VarChar(20)
  name             String             @db.VarChar(250)
  readonly         Boolean            @default(false)
  item_order       Int                @default(0)
  business_partner business_partner[]
  tenant           tenant[]
}

model permission {
  id                 String          @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  role_id            String          @db.Uuid
  app_sub_module_id  Int
  access_scope_id    Int
  permission_type_id Int
  readonly           Boolean         @default(false)
  item_order         Int             @default(0)
  created_at         DateTime        @default(now()) @db.Timestamptz(6)
  created_by         String?         @db.Uuid
  updated_at         DateTime?       @db.Timestamptz(6)
  updated_by         String?         @db.Uuid
  removed_at         DateTime?       @db.Timestamptz(6)
  removed_by         String?         @db.Uuid
  access_scope       access_scope    @relation(fields: [access_scope_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  app_sub_module     app_sub_module  @relation(fields: [app_sub_module_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  permission_type    permission_type @relation(fields: [permission_type_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  role               role            @relation(fields: [role_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([role_id, app_sub_module_id, removed_at], map: "uq_permission")
}

model permission_type {
  id          Int          @id @default(autoincrement())
  name        String       @db.VarChar(50)
  code        String       @unique @db.VarChar(20)
  description String?
  item_order  Int          @default(0)
  readonly    Boolean      @default(false)
  permission  permission[]
}

model platform {
  id         Int          @id @default(autoincrement())
  name       String?      @db.VarChar(100)
  code       String?      @unique @db.VarChar(50)
  readonly   Boolean      @default(false)
  app_module app_module[]
}

model role {
  id          String       @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  code        String       @db.VarChar(50)
  name        String       @db.VarChar(100)
  description String?
  readonly    Boolean      @default(false)
  item_order  Int          @default(0)
  created_at  DateTime     @default(now()) @db.Timestamptz(6)
  created_by  String?      @db.Uuid
  updated_at  DateTime?    @db.Timestamptz(6)
  updated_by  String?      @db.Uuid
  removed_at  DateTime?    @db.Timestamptz(6)
  removed_by  String?      @db.Uuid
  app_user    app_user[]
  permission  permission[]

  @@unique([code, removed_at], map: "uq_role")
}

model service {
  id                       String                     @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                String                     @db.Uuid
  service_category_id      String                     @db.Uuid
  code                     String                     @db.VarChar(100)
  name                     String                     @db.VarChar(255)
  base_price               Decimal                    @default(0) @db.Decimal(15, 2)
  base_cost                Decimal                    @default(0) @db.Decimal(15, 2)
  active                   Boolean                    @default(true)
  created_at               DateTime                   @default(now()) @db.Timestamptz(6)
  created_by               String?                    @db.Uuid
  updated_at               DateTime?                  @db.Timestamptz(6)
  updated_by               String?                    @db.Uuid
  removed_at               DateTime?                  @db.Timestamptz(6)
  removed_by               String?                    @db.Uuid
  service_category         service_category           @relation(fields: [service_category_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenant                   tenant                     @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  service_business_unit    service_business_unit[]
  service_order_item       service_order_item[]
  service_provider_service service_provider_service[]

  @@unique([tenant_id, code, removed_at], map: "uq_service")
}

model service_business_unit {
  id               String        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  service_id       String        @db.Uuid
  business_unit_id String        @db.Uuid
  price            Decimal       @default(0) @db.Decimal(15, 2)
  cost             Decimal       @default(0) @db.Decimal(15, 2)
  active           Boolean       @default(true)
  extra_data       Json?
  created_at       DateTime      @default(now()) @db.Timestamptz(6)
  created_by       String?       @db.Uuid
  updated_at       DateTime?     @db.Timestamptz(6)
  updated_by       String?       @db.Uuid
  business_unit    business_unit @relation(fields: [business_unit_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  service          service       @relation(fields: [service_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([service_id, business_unit_id])
}

model service_category {
  id         String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id  String    @db.Uuid
  code       String    @db.VarChar(50)
  name       String    @db.VarChar(100)
  active     Boolean   @default(true)
  created_at DateTime  @default(now()) @db.Timestamptz(6)
  created_by String?   @db.Uuid
  updated_at DateTime? @db.Timestamptz(6)
  updated_by String?   @db.Uuid
  removed_at DateTime? @db.Timestamptz(6)
  removed_by String?   @db.Uuid
  service    service[]
  tenant     tenant    @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([tenant_id, code, removed_at], map: "uq_service_category")
}

model service_order {
  id                                                           String                  @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                                                    String                  @db.Uuid
  business_unit_id                                             String                  @db.Uuid
  customer_id                                                  String                  @db.Uuid
  agent_id                                                     String                  @db.Uuid
  document_status_id                                           Int
  document_type_id                                             Int
  total_amount                                                 Decimal                 @default(0) @db.Decimal(15, 2)
  scheduled_at                                                 DateTime?               @db.Timestamptz(6)
  extra_data                                                   Json?
  created_at                                                   DateTime                @default(now()) @db.Timestamptz(6)
  created_by                                                   String?                 @db.Uuid
  updated_at                                                   DateTime?               @db.Timestamptz(6)
  updated_by                                                   String?                 @db.Uuid
  removed_at                                                   DateTime?               @db.Timestamptz(6)
  removed_by                                                   String?                 @db.Uuid
  business_partner_service_order_agent_idTobusiness_partner    business_partner        @relation("service_order_agent_idTobusiness_partner", fields: [agent_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  business_unit                                                business_unit           @relation(fields: [business_unit_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  business_partner_service_order_customer_idTobusiness_partner business_partner        @relation("service_order_customer_idTobusiness_partner", fields: [customer_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  document_status                                              document_status         @relation(fields: [document_status_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  document_type                                                document_type           @relation(fields: [document_type_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenant                                                       tenant                  @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  service_order_details                                        service_order_details[]
  service_order_item                                           service_order_item[]
}

model service_order_details {
  id               String        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  service_order_id String        @db.Uuid
  symptoms         String?
  diagnosis        String?
  treatment_plan   String?
  prescription     Json?
  extra_data       Json?
  start_at         DateTime?     @db.Timestamptz(6)
  end_at           DateTime?     @db.Timestamptz(6)
  created_at       DateTime      @default(now()) @db.Timestamptz(6)
  created_by       String?       @db.Uuid
  updated_at       DateTime?     @db.Timestamptz(6)
  updated_by       String?       @db.Uuid
  removed_at       DateTime?     @db.Timestamptz(6)
  removed_by       String?       @db.Uuid
  service_order    service_order @relation(fields: [service_order_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model service_order_item {
  id               String        @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  service_order_id String        @db.Uuid
  service_id       String        @db.Uuid
  quantity         Decimal       @db.Decimal(15, 3)
  unit_price       Decimal       @db.Decimal(15, 2)
  service          service       @relation(fields: [service_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  service_order    service_order @relation(fields: [service_order_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([service_order_id, service_id])
}

model service_provider {
  id                        String                      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id                 String                      @db.Uuid
  business_partner_id       String                      @db.Uuid
  active                    Boolean                     @default(true)
  extra_data                Json?
  created_at                DateTime                    @default(now()) @db.Timestamptz(6)
  updated_at                DateTime?                   @db.Timestamptz(6)
  business_partner          business_partner            @relation(fields: [business_partner_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenant                    tenant                      @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  service_provider_schedule service_provider_schedule[]
  service_provider_service  service_provider_service[]

  @@unique([tenant_id, business_partner_id])
}

model service_provider_schedule {
  id                    String           @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id             String           @db.Uuid
  business_unit_id      String           @db.Uuid
  service_provider_id   String           @db.Uuid
  day_of_week           Int
  start_time            DateTime         @db.Time(6)
  end_time              DateTime         @db.Time(6)
  slot_duration_minutes Int              @default(60)
  active                Boolean          @default(true)
  created_at            DateTime         @default(now()) @db.Timestamptz(6)
  business_unit         business_unit    @relation(fields: [business_unit_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  service_provider      service_provider @relation(fields: [service_provider_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenant                tenant           @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([tenant_id, business_unit_id, service_provider_id, day_of_week, start_time, end_time])
}

model service_provider_service {
  id                  String           @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id           String           @db.Uuid
  business_unit_id    String           @db.Uuid
  service_provider_id String           @db.Uuid
  service_id          String           @db.Uuid
  active              Boolean          @default(true)
  created_at          DateTime         @default(now()) @db.Timestamptz(6)
  business_unit       business_unit    @relation(fields: [business_unit_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  service             service          @relation(fields: [service_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  service_provider    service_provider @relation(fields: [service_provider_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenant              tenant           @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([tenant_id, business_unit_id, service_provider_id, service_id])
}

model tenant {
  id                        String                      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  identification_type_id    Int
  identification_number     String                      @db.VarChar(255)
  code                      String                      @unique @db.VarChar(50)
  business_name             String                      @db.VarChar(255)
  email                     String?                     @db.VarChar(255)
  phone                     String?                     @db.VarChar(50)
  active                    Boolean                     @default(true)
  created_at                DateTime                    @default(now()) @db.Timestamptz(6)
  created_by                String?                     @db.Uuid
  updated_at                DateTime?                   @db.Timestamptz(6)
  updated_by                String?                     @db.Uuid
  readonly                  Boolean                     @default(false)
  business_partner          business_partner[]
  business_unit             business_unit[]
  service                   service[]
  service_category          service_category[]
  service_order             service_order[]
  service_provider          service_provider[]
  service_provider_schedule service_provider_schedule[]
  service_provider_service  service_provider_service[]
  identification_type       identification_type         @relation(fields: [identification_type_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([identification_number, identification_type_id])
}

model business_partner_business_unit {
  id                  String           @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  business_partner_id String           @db.Uuid
  business_unit_id    String           @db.Uuid
  created_at          DateTime         @default(now()) @db.Timestamptz(6)
  business_partner    business_partner @relation(fields: [business_partner_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  business_unit       business_unit    @relation(fields: [business_unit_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([business_partner_id, business_unit_id], map: "business_partner_business_uni_business_partner_id_business__key")
}
